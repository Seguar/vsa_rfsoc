function result = iqresample(data, n2)
% Resample data to n2 samples (data can be real or complex)
% The routine takes care of removing wrap-around artefacts
% Result of row vector will be a row vector, col vector will stay col vector
% Copyright Keysight Technologies 2015
c_tap = [ 4.2692172372382302e-05;-0.00034281078675024002;0.0015924449256957799;-0.0055781926557395998;0.0162895246973494;-0.041741209705054003;0.096753107749443401;-0.206928159240231;0.41402257410808802;-0.78281582419267104;1.40944840635463;-2.4310124787443099;4.0359368853231397;-6.4743855101656296;10.067393293606001;-15.212612166914001;22.382899444765901;-32.110713171667904;44.944721145681697;-61.352157208939097;81.516305643260196;-104.937751739841;129.69905873082999;-151.290671361774;161.52449188445601;];
s0 = [...
4.3476414713074484e-16 8.6191254008409753e-11 3.5215179899695203e-10 8.2018666590688409e-10 1.5279385183381991e-09 2.5290919507515153e-09 3.8943619995266397e-09 5.7127698571486742e-09 8.0932100572891536e-09 1.1166313119584197e-08 1.5086609520046296e-08 2.0035000956966221e-08 2.6221545839186506e-08 3.3888566939907291e-08 4.3314089662692848e-08 5.4815620186444489e-08 6.8754273506363925e-08 8.5539262227074134e-08 1.0563275741017238e-07 1.2955513369774173e-07 1.5789061153497387e-07 1.912933096334331e-07 2.304937224220033e-07 2.7630563597562717e-07 3.2963349870416073e-07 3.9148026194690422e-07 4.6295570651828183e-07 5.4528527267866771e-07 6.3981940957076362e-07 7.4804346236841579e-07 8.7158811467478046e-07 1.0122404047900224e-06 1.1719553336702991e-06 1.3528680836605573e-06 1.5573068675054759e-06 1.7878064251799091e-06 2.0471221896331569e-06 2.3382451395663197e-06 2.6644173584124296e-06 3.0291483203633071e-06 3.4362319201091215e-06 3.8897642680886022e-06 4.3941622684396026e-06 4.9541829988056819e-06 5.5749439109435871e-06 6.2619438695629609e-06 7.0210850471331486e-06 7.8586956928949562e-06 8.7815537913018204e-06 9.796911627889416e-06 1.0912521276421361e-05 1.2136661023371677e-05 1.347816274376265e-05 1.4946440241299487e-05 1.6551518565886518e-05 1.8304064319391802e-05 2.0215416961261815e-05 2.2297621122287921e-05 2.4563459936401609e-05 2.7026489396278496e-05 2.970107374012515e-05 3.2602421873179718e-05 3.5746624828159312e-05 3.9150694266157371e-05 ;
4.2832602018483864e-05 4.6811320668328055e-05 5.1106865169309033e-05 5.5740335497090814e-05 6.0733960326884802e-05 6.6111141729941779e-05 7.1896500878423716e-05 7.8115924747162885e-05 8.4796613799017234e-05 9.1967130637158123e-05 9.9657449607270114e-05 0.00010789900732960011 0.00011672475413812699 0.00012616920640346789 0.00013626849971208518 0.00014706044287277301 0.00015858457272014531 0.00017088220968001537 0.00018399651406165939 0.00019797254303757794 0.00021285730827021721 0.00022869983414118892 0.00024555121653772682 0.00026346468214706234 0.00028249564820710806 0.0003027017826601691 0.00032414306465212262 0.0003468818453185298 0.00037098290879589369 0.00039651353339239062 0.00042354355285250804 0.00045214541764454323 0.00048239425619902199 0.00051436793602336836 0.00054814712461451003 0.000583815350089954 0.00062145906145460973 0.00066116768841744907 0.00070303370067198955 0.00074715266654904855 0.00079362331095035837 0.00084254757246823983 0.00089403065959458054 0.00094818110591982216 0.0010051108242212095 0.0010649351593369294 0.0011277729397212522 0.0011937465275735847 0.0012629818674328936 0.0013356085331269224 0.0014117597729646077 0.0014915725530579246 0.0015751875986587303 0.001662749433394374 0.0017544064162851598 0.0018503107764255128 0.0019506186452099199 0.0020554900859838755 0.0021650891209998965 0.0022795837555575895 0.0023991459992070458 0.0025239518838944437 0.0026541814789288274 0.0027900189026490263 ;
0.0029316523306706114 0.0030792740005925936 0.0032330802130447066 0.0033932713289569973 0.0035600517629344169 0.0037336299726201862 0.0039142184439335918 0.0041020336720690616 0.0042972961381454212 0.0045002302813962345 0.0047110644667940609 0.0049300309480045336 0.0051573658255680355 0.0053933090002096914 0.005638104121182346 0.0058919985295487068 0.0061552431963139064 0.0064280926553222598 0.0067108049308363523 0.0070036414597207438 0.0073068670081558457 0.007620749582813207 0.0079455603364276452 0.0082815734677054997 0.0086290661155151629 0.0089883182473095014 0.0093596125417362008 0.0097432342653973967 0.010139471143725317 0.01054861322594745 0.010970952744120136 0.011406783966215805 0.011856403043256058 0.012320107850488848 0.012798197822615253 0.013290973783077519 0.013798737767428069 0.014321792840805736 0.014860442909552447 0.015414992527012172 0.015985746693560291 0.016573010650920181 0.017177089670830176 0.017798288838134082 0.018436912828373751 0.019093265679972524 0.019767650561104733 0.020460369531355421 0.02117172329828234 0.021902010969000265 0.022651529796916595 0.023420574923753802 0.024209439117004593 0.025018412502972324 0.025847782295557439 0.026697832520960019 0.027568843738475211 0.028461092757566673 0.029374852351412448 0.030310390967123377 0.031267972432843079 0.032247855661947523 0.033250294354566674 0.0342755366966606 ;
0.035323825056889718 0.036395395681523973 0.03749047838764491 0.038609296254900297 0.039752065316077716 0.040918994246770111 0.042110284054412354 0.043326127766973532 0.044566710121596721 0.04583220725348134 0.04712278638531054 0.048438605517529737 0.049779813119787068 0.051146547823852598 0.052538938118334204 0.053957102045514911 0.055401146900638139 0.056871168933970866 0.058367253055977238 0.059889472545938571 0.061437888764356303 0.063012550869477726 0.064613495538284091 0.0662407466922834 0.067894315228448646 0.069574198755644939 0.071280381336886467 0.073012833237765057 0.074771510681390596 0.076556355610181759 0.078367295454845054 0.080204242910875079 0.082067095722910405 0.083955736477271573 0.085870032403008029 0.087809835181775237 0.089774980766857401 0.091765289211650503 0.093780564507909323 0.095820594434061976 0.09788515041388593 0.099973987385832824 0.10208684368328606 0.10422344092602211 0.10638348392314367 0.10856666058774218 0.11077264186353823 0.11300108166374087 0.1152516168223565 0.11752386705816781 0.11981743495159448 0.12213190593463458 0.12446684829407741 0.12682181318816499 0.12919633467686839 0.13158992976593467 0.1340020984648449 0.13643232385881457 0.13888007219495224 0.14134479298268024 0.14382591910850831 0.14632286696523575 0.14883503659564609 0.15136181185074127 ;
0.15390256056255136 0.15645663473153826 0.15902337072859873 0.16160208951165728 0.16419209685682332 0.16679268360407348 0.16940312591740364 0.17202268555937869 0.17465061017999639 0.177286133619762 0.17992847622685779 0.182576845188274 0.18523043487475402 0.18788842719938981 0.19054999198968947 0.19321428737292037 0.19588046017452096 0.19854764632935468 0.20121497130556565 0.20388155054078269 0.2065464898903997 0.2092088860876504 0.21186782721517619 0.21452239318777586 0.21717165624600854 0.21981468146031052 0.22245052724527065 0.22507824588369657 0.22769688406009239 0.23030548340315493 0.23290308103688184 0.23548871013987716 0.23806140051242322 0.24062017915088277 0.24316407082897762 0.24569209868548614 0.24820328481788953 0.25069665088148479 0.25317121869348064 0.25562601084157532 0.25806005129651499 0.26047236602811963 0.26286198362425817 0.26522793591224775 0.2675692585821472 0.26988499181140785 0.2721741808903424 0.27443587684786636 0.27666913707696517 0.27887302595933555 0.28104661548864746 0.28318898589187319 0.28529922624812765 0.2873764351044617 0.28941972108805464 0.29142820351424914 0.29340101298987559 0.29533729201131254 0.29723619555673503 0.29909689167200471 0.30091856204965794 0.30270040260045677 0.30444162401696695 0.30614145232863915 ;
0.30779912944786952 0.30941391370652943 0.31098508038245382 0.31251192221539409 0.31399374991194273 0.3154298926389521 0.31681969850497405 0.31816253502926178 0.31945778959788562 0.32070486990652142 0.32190320438948938 0.32305224263462662 0.32415145578359494 0.32520033691723466 0.32619840142559275 0.32714518736226467 0.32804025578270513 0.32888319106618102 0.329673601221048 0.33041111817305768 0.33109539803640969 0.33172612136728535 0.33230299339961455 0.33282574426284328 0.33329412918149026 0.33370792865629406 0.33406694862677527 0.33437102061505181 0.33462000185076707 0.33481377537700713 0.33495225013710289 0.33503536104223247 0.3350630690197553 0.33503536104223247 0.33495225013710289 0.33481377537700713 0.33462000185076707 0.33437102061505181 0.33406694862677527 0.33370792865629406 0.33329412918149026 0.33282574426284328 0.33230299339961455 0.33172612136728535 0.33109539803640969 0.33041111817305768 0.329673601221048 0.32888319106618102 0.32804025578270513 0.32714518736226467 0.32619840142559275 0.32520033691723466 0.32415145578359494 0.32305224263462662 0.32190320438948938 0.32070486990652142 0.31945778959788562 0.31816253502926178 0.31681969850497405 0.3154298926389521 0.31399374991194273 0.31251192221539409 0.31098508038245382 0.30941391370652943 ;
0.30779912944786952 0.30614145232863915 0.30444162401696695 0.30270040260045677 0.30091856204965794 0.29909689167200471 0.29723619555673503 0.29533729201131254 0.29340101298987559 0.29142820351424914 0.28941972108805464 0.2873764351044617 0.28529922624812765 0.28318898589187319 0.28104661548864746 0.27887302595933555 0.27666913707696517 0.27443587684786636 0.2721741808903424 0.26988499181140785 0.2675692585821472 0.26522793591224775 0.26286198362425817 0.26047236602811963 0.25806005129651499 0.25562601084157532 0.25317121869348064 0.25069665088148479 0.24820328481788953 0.24569209868548614 0.24316407082897762 0.24062017915088277 0.23806140051242322 0.23548871013987716 0.23290308103688184 0.23030548340315493 0.22769688406009239 0.22507824588369657 0.22245052724527065 0.21981468146031052 0.21717165624600854 0.21452239318777586 0.21186782721517619 0.2092088860876504 0.2065464898903997 0.20388155054078269 0.20121497130556565 0.19854764632935468 0.19588046017452096 0.19321428737292037 0.19054999198968947 0.18788842719938981 0.18523043487475402 0.182576845188274 0.17992847622685779 0.177286133619762 0.17465061017999639 0.17202268555937869 0.16940312591740364 0.16679268360407348 0.16419209685682332 0.16160208951165728 0.15902337072859873 0.15645663473153826 ;
0.15390256056255136 0.15136181185074127 0.14883503659564609 0.14632286696523575 0.14382591910850831 0.14134479298268024 0.13888007219495224 0.13643232385881457 0.1340020984648449 0.13158992976593467 0.12919633467686839 0.12682181318816499 0.12446684829407741 0.12213190593463458 0.11981743495159448 0.11752386705816781 0.1152516168223565 0.11300108166374087 0.11077264186353823 0.10856666058774218 0.10638348392314367 0.10422344092602211 0.10208684368328606 0.099973987385832824 0.09788515041388593 0.095820594434061976 0.093780564507909323 0.091765289211650503 0.089774980766857401 0.087809835181775237 0.085870032403008029 0.083955736477271573 0.082067095722910405 0.080204242910875079 0.078367295454845054 0.076556355610181759 0.074771510681390596 0.073012833237765057 0.071280381336886467 0.069574198755644939 0.067894315228448646 0.0662407466922834 0.064613495538284091 0.063012550869477726 0.061437888764356303 0.059889472545938571 0.058367253055977238 0.056871168933970866 0.055401146900638139 0.053957102045514911 0.052538938118334204 0.051146547823852598 0.049779813119787068 0.048438605517529737 0.04712278638531054 0.04583220725348134 0.044566710121596721 0.043326127766973532 0.042110284054412354 0.040918994246770111 0.039752065316077716 0.038609296254900297 0.03749047838764491 0.036395395681523973 ;
0.035323825056889718 0.0342755366966606 0.033250294354566674 0.032247855661947523 0.031267972432843079 0.030310390967123377 0.029374852351412448 0.028461092757566673 0.027568843738475211 0.026697832520960019 0.025847782295557439 0.025018412502972324 0.024209439117004593 0.023420574923753802 0.022651529796916595 0.021902010969000265 0.02117172329828234 0.020460369531355421 0.019767650561104733 0.019093265679972524 0.018436912828373751 0.017798288838134082 0.017177089670830176 0.016573010650920181 0.015985746693560291 0.015414992527012172 0.014860442909552447 0.014321792840805736 0.013798737767428069 0.013290973783077519 0.012798197822615253 0.012320107850488848 0.011856403043256058 0.011406783966215805 0.010970952744120136 0.01054861322594745 0.010139471143725317 0.0097432342653973967 0.0093596125417362008 0.0089883182473095014 0.0086290661155151629 0.0082815734677054997 0.0079455603364276452 0.007620749582813207 0.0073068670081558457 0.0070036414597207438 0.0067108049308363523 0.0064280926553222598 0.0061552431963139064 0.0058919985295487068 0.005638104121182346 0.0053933090002096914 0.0051573658255680355 0.0049300309480045336 0.0047110644667940609 0.0045002302813962345 0.0042972961381454212 0.0041020336720690616 0.0039142184439335918 0.0037336299726201862 0.0035600517629344169 0.0033932713289569973 0.0032330802130447066 0.0030792740005925936 ;
0.0029316523306706114 0.0027900189026490263 0.0026541814789288274 0.0025239518838944437 0.0023991459992070458 0.0022795837555575895 0.0021650891209998965 0.0020554900859838755 0.0019506186452099199 0.0018503107764255128 0.0017544064162851598 0.001662749433394374 0.0015751875986587303 0.0014915725530579246 0.0014117597729646077 0.0013356085331269224 0.0012629818674328936 0.0011937465275735847 0.0011277729397212522 0.0010649351593369294 0.0010051108242212095 0.00094818110591982216 0.00089403065959458054 0.00084254757246823983 0.00079362331095035837 0.00074715266654904855 0.00070303370067198955 0.00066116768841744907 0.00062145906145460973 0.000583815350089954 0.00054814712461451003 0.00051436793602336836 0.00048239425619902199 0.00045214541764454323 0.00042354355285250804 0.00039651353339239062 0.00037098290879589369 0.0003468818453185298 0.00032414306465212262 0.0003027017826601691 0.00028249564820710806 0.00026346468214706234 0.00024555121653772682 0.00022869983414118892 0.00021285730827021721 0.00019797254303757794 0.00018399651406165939 0.00017088220968001537 0.00015858457272014531 0.00014706044287277301 0.00013626849971208518 0.00012616920640346789 0.00011672475413812699 0.00010789900732960011 9.9657449607270114e-05 9.1967130637158123e-05 8.4796613799017234e-05 7.8115924747162885e-05 7.1896500878423716e-05 6.6111141729941779e-05 6.0733960326884802e-05 5.5740335497090814e-05 5.1106865169309033e-05 4.6811320668328055e-05 ;
4.2832602018483864e-05 3.9150694266157371e-05 3.5746624828159312e-05 3.2602421873179718e-05 2.970107374012515e-05 2.7026489396278496e-05 2.4563459936401609e-05 2.2297621122287921e-05 2.0215416961261815e-05 1.8304064319391802e-05 1.6551518565886518e-05 1.4946440241299487e-05 1.347816274376265e-05 1.2136661023371677e-05 1.0912521276421361e-05 9.796911627889416e-06 8.7815537913018204e-06 7.8586956928949562e-06 7.0210850471331486e-06 6.2619438695629609e-06 5.5749439109435871e-06 4.9541829988056819e-06 4.3941622684396026e-06 3.8897642680886022e-06 3.4362319201091215e-06 3.0291483203633071e-06 2.6644173584124296e-06 2.3382451395663197e-06 2.0471221896331569e-06 1.7878064251799091e-06 1.5573068675054759e-06 1.3528680836605573e-06 1.1719553336702991e-06 1.0122404047900224e-06 8.7158811467478046e-07 7.4804346236841579e-07 6.3981940957076362e-07 5.4528527267866771e-07 4.6295570651828183e-07 3.9148026194690422e-07 3.2963349870416073e-07 2.7630563597562717e-07 2.304937224220033e-07 1.912933096334331e-07 1.5789061153497387e-07 1.2955513369774173e-07 1.0563275741017238e-07 8.5539262227074134e-08 6.8754273506363925e-08 5.4815620186444489e-08 4.3314089662692848e-08 3.3888566939907291e-08 2.6221545839186506e-08 2.0035000956966221e-08 1.5086609520046296e-08 1.1166313119584197e-08 8.0932100572891536e-09 5.7127698571486742e-09 3.8943619995266397e-09 2.5290919507515153e-09 1.5279385183381991e-09 8.2018666590688409e-10 3.5215179899695203e-10 8.6191254008409753e-11 ];
s1 = [...
8.6190819244262625e-11 2.6596054498854228e-10 4.6803486690993206e-10 7.0775185243131505e-10 1.0011534324133162e-09 1.3652700487751244e-09 1.8184078576220345e-09 2.3804402001404794e-09 3.0731030622950433e-09 3.9202964004620994e-09 4.9483914369199242e-09 6.1865448822202854e-09 7.6670211007207855e-09 9.4255227227855564e-09 1.1501530523751641e-08 1.3938653319919436e-08 1.6784988720710209e-08 2.0093495183098244e-08 2.3922376287569348e-08 2.8335477837232146e-08 3.340269809845923e-08 3.9200412788570196e-08 4.5811913553623873e-08 5.3327862728533556e-08 6.1846763242743495e-08 7.1475444571377608e-08 8.2329566160385884e-08 9.4534136892095902e-08 1.0822405279765218e-07 1.2354465230636466e-07 1.4065229011524193e-07 1.5971492888027674e-07 1.8091274999025819e-07 2.0443878384491862e-07 2.3049955767443319e-07 2.5931576445324776e-07 2.9112294993316284e-07 3.2617221884610985e-07 3.6473096195087755e-07 4.0708359974581441e-07 4.5353234797948063e-07 5.0439800035100044e-07 5.6002073036607934e-07 6.2076091213790515e-07 6.8699995861937379e-07 7.5914117757018768e-07 8.3761064576180767e-07 9.2285809840686415e-07 1.0153578365875956e-06 1.1156096485319445e-06 1.2241397469503166e-06 1.3415017203909727e-06 1.4682774975368376e-06 1.6050783245870309e-06 1.752545753505284e-06 1.9113526418700126e-06 2.0822041610261059e-06 2.2658388141136879e-06 2.4630294598768868e-06 2.6745843438466546e-06 2.9013481330545681e-06 3.1442029549795934e-06 3.4040694379980591e-06 3.6819077523264935e-06 ; ...
3.9787186498441911e-06 4.2955445009809775e-06 4.6334703277817811e-06 4.9936248297939885e-06 5.3771814030569769e-06 5.7853591484819365e-06 6.2194238687391691e-06 6.6806890518543492e-06 7.1705168381408892e-06 7.6903189701119903e-06 8.2415577223299936e-06 8.825746808526882e-06 9.4444522653409002e-06 1.0099293308617289e-05 1.0791943160687827e-05 1.1524129847372309e-05 1.2297636959870056e-05 1.3114304381644018e-05 1.3976028975918551e-05 1.4884765232639274e-05 1.5842525870971702e-05 1.6851382396537902e-05 1.7913465609335527e-05 1.903096606004572e-05 2.0206134453061033e-05 2.1441281991953524e-05 2.2738780666407181e-05 2.4101063477363887e-05 2.5530624596496927e-05 2.7030019460117427e-05 2.8601864792035189e-05 3.0248838554478756e-05 3.1973679824346367e-05 3.3779188591141675e-05 3.5668225475443964e-05 3.7643711364655731e-05 3.9708626962839345e-05 4.1866012254540477e-05 4.4118965877058998e-05 4.6470644401309827e-05 4.8924261517881455e-05 5.148308712634071e-05 5.4150446325241619e-05 5.6929718301387388e-05 5.9824335115719884e-05 6.283778038432275e-05 6.5973587852332554e-05 6.9235339859308838e-05 7.2626665694028878e-05 7.6151239837685299e-05 7.9812780093316835e-05 8.3615045600805675e-05 8.7561834735643777e-05 9.1656982890785761e-05 9.5904360140353041e-05 0.00010030786878440705 0.00010487144077395562 0.00010959903501602105 0.00011449463455769299 0.00011956224364945622 0.00012480588468739796 0.00013022959503438368 0.00013583742372019888 0.00014163342802158514 ; ...
0.00014762166992198216 0.00015380621245211301 0.00016019111591229068 0.00016678043397741959 0.00017357820968576937 0.00018058847131340559 0.00018781522813546975 0.00019526246607635966 0.00020293414325081322 0.00021083418539782645 0.00021896648121047264 0.00022733487756350194 0.00023594317464165591 0.00024479512097265455 0.00025389440836636086 0.00026324466676519963 0.00027284945900835338 0.00028271227551409251 0.00029283652888439145 0.00030322554843510187 0.00031388257465736133 0.00032481075361443824 0.0003360131312778545 0.00034749264780966314 0.00035925213179433847 0.00037129429442669948 0.00038362172366119586 0.00039623687832792027 0.00040914208222213311 0.00042233951817268606 0.00043583122209566935 0.00044961907704025271 0.00046370480723278984 0.00047808997212640467 0.00049277596046226613 0.00050776398435055034 0.00052305507337766649 0.00053865006874671134 0.00055454961745972538 0.00057075416654811875 0.00058726395735989034 0.00060407901990999421 0.0006211991673039062 0.0006386239902396694 0.00065635285159877307 0.00067438488113220896 0.00069271897025068724 0.00071135376692691918 0.00073028767071792525 0.00074951882791633034 0.00076904512683720685 0.0007888641932507906 0.00080897338596773102 0.00082936979258511553 0.00085005022540258005 0.00087101121751519128 0.00089224901909146226 0.00091375959384577474 0.00093553861571092981 0.0009575814657197014 0.00097988322910444459 0.0010024386926191509 0.0010252423420939252 0.0010482883602291188 ; ...
0.0010715706246342549 0.0010950827061209367 0.0011188178672553867 0.0011427690611774191 0.0011669289306923958 0.0011912898076422429 0.0012158437125611779 0.0012405823546231889 0.0012654971318846187 0.0012905791318292004 0.0013158191322191967 0.0013412076022573313 0.0013667347040655295 0.0013923902944816061 0.0014181639271807073 0.0014440448551232277 0.0014700220333327269 0.001496084122006372 0.0015222194899613337 0.0015484162184177322 0.001574662105121423 0.0016009446688063644 0.0016272511539993095 0.0016535685361652452 0.0016798835271962936 0.0017061825812415277 0.0017324519008785899 0.0017586774436255392 0.0017848449287911627 0.0018109398446632952 0.0018369474560300247 0.001862852812035326 0.0018886407543611677 0.0019142959257364561 0.0019398027787672079 0.0019651455850821647 0.0019903084447931013 0.00201527529625882 0.0020400299261526533 0.0020645559798239538 0.0020888369719468947 0.0021128562974532389 0.0021365972427360436 0.0021600429971215668 0.0021831766645985101 0.0022059812757960484 0.002228439800202639 0.0022505351586156325 0.0022722502358113045 0.0022935678934266762 0.0023144709830400928 0.0023349423594428292 0.0023549648940875828 0.0023745214887034016 0.0023935950890662805 0.0024121686989102276 0.0024302253939696705 0.0024477483361376728 0.0024647207877279975 0.0024811261258280704 0.0024969478567274384 0.0025121696304103436 0.0025267752550951761 0.0025407487118100924 ; ...
0.0025540741689868973 0.0025667359970604764 0.0025787187830585423 0.0025900073451660399 0.0026005867472501665 0.002610442313330158 0.00261955964197505 0.0026279246206176998 0.0026355234397656135 0.0026423426070957823 0.0026483689614162087 0.0026535896864800235 0.0026579923246357884 0.0026615647902996642 0.0026642953832309024 0.0026661728016005859 0.0026671861548337172 0.0026673249762109719 0.0026665792352170425 0.0026649393496170071 0.0026623961972506993 0.0026589411275257935 0.0026545659725996651 0.0026492630582326815 0.0026430252143019861 0.0026358457849601225 0.0026277186384259243 0.0026186381763958211 0.0026085993430625398 0.0025975976337269113 0.0025856291029953127 0.0025726903725460659 0.0025587786384595468 0.0025438916780948506 0.002528027856508519 0.0025111861324033924 0.0024933660635952648 0.0024745678119958425 0.0024547921480946866 0.0024340404549396677 0.0024123147316046367 0.002389617596138538 0.0023659522879895811 0.0023413226698994483 0.0023157332292606525 0.0022891890789345504 0.002261695957523957 0.0022332602290988102 0.0022038888823703862 0.0021735895293119034 0.0021423704032257351 0.0021102403562544558 0.0020772088563340563 0.0020432859835929351 0.0020084824261945022 0.0019728094756264469 0.0019362790214369485 0.0018989035454224923 0.0018606961152696777 0.0018216703776532395 0.00178184055079883 0.0017412214165101747 0.0016998283116722024 0.0016576771192303719 ; ...
0.001614784258659907 0.0015711666759243847 0.0015268418329402733 0.0014818276965486432 0.0014361427270093707 0.0013898058660219426 0.0013428365242877383 0.0012952545686238381 0.0012470803086357951 0.0011983344829679665 0.001149038245137235 0.0010992131489683254 0.0010488811336397119 0.00099806450835809857 0.00094678593667191224 0.00089506842044045909 0.00084293528347589852 0.00079041015486697175 0.00073751695200968692 0.00068427986335201085 0.0006307233308756599 0.00057687203232920092 0.00052275086322872699 0.00046838491864698018 0.00041379947480379986 0.00035901997048121137 0.00030407198827653303 0.00024898123571526209 0.00019377352624005972 0.00013847476009576365 8.3110905129579749e-05 2.7707977522828386e-05 -2.7707977522828386e-05 -8.3110905129579749e-05 -0.00013847476009576365 -0.00019377352624005972 -0.00024898123571526209 -0.00030407198827653303 -0.00035901997048121137 -0.00041379947480379986 -0.00046838491864698018 -0.00052275086322872699 -0.00057687203232920092 -0.0006307233308756599 -0.00068427986335201085 -0.00073751695200968692 -0.00079041015486697175 -0.00084293528347589852 -0.00089506842044045909 -0.00094678593667191224 -0.00099806450835809857 -0.0010488811336397119 -0.0010992131489683254 -0.001149038245137235 -0.0011983344829679665 -0.0012470803086357951 -0.0012952545686238381 -0.0013428365242877383 -0.0013898058660219426 -0.0014361427270093707 -0.0014818276965486432 -0.0015268418329402733 -0.0015711666759243847 -0.001614784258659907 ; ...
-0.0016576771192303719 -0.0016998283116722024 -0.0017412214165101747 -0.00178184055079883 -0.0018216703776532395 -0.0018606961152696777 -0.0018989035454224923 -0.0019362790214369485 -0.0019728094756264469 -0.0020084824261945022 -0.0020432859835929351 -0.0020772088563340563 -0.0021102403562544558 -0.0021423704032257351 -0.0021735895293119034 -0.0022038888823703862 -0.0022332602290988102 -0.002261695957523957 -0.0022891890789345504 -0.0023157332292606525 -0.0023413226698994483 -0.0023659522879895811 -0.002389617596138538 -0.0024123147316046367 -0.0024340404549396677 -0.0024547921480946866 -0.0024745678119958425 -0.0024933660635952648 -0.0025111861324033924 -0.002528027856508519 -0.0025438916780948506 -0.0025587786384595468 -0.0025726903725460659 -0.0025856291029953127 -0.0025975976337269113 -0.0026085993430625398 -0.0026186381763958211 -0.0026277186384259243 -0.0026358457849601225 -0.0026430252143019861 -0.0026492630582326815 -0.0026545659725996651 -0.0026589411275257935 -0.0026623961972506993 -0.0026649393496170071 -0.0026665792352170425 -0.0026673249762109719 -0.0026671861548337172 -0.0026661728016005859 -0.0026642953832309024 -0.0026615647902996642 -0.0026579923246357884 -0.0026535896864800235 -0.0026483689614162087 -0.0026423426070957823 -0.0026355234397656135 -0.0026279246206176998 -0.00261955964197505 -0.002610442313330158 -0.0026005867472501665 -0.0025900073451660399 -0.0025787187830585423 -0.0025667359970604764 -0.0025540741689868973 ; ...
-0.0025407487118100924 -0.0025267752550951761 -0.0025121696304103436 -0.0024969478567274384 -0.0024811261258280704 -0.0024647207877279975 -0.0024477483361376728 -0.0024302253939696705 -0.0024121686989102276 -0.0023935950890662805 -0.0023745214887034016 -0.0023549648940875828 -0.0023349423594428292 -0.0023144709830400928 -0.0022935678934266762 -0.0022722502358113045 -0.0022505351586156325 -0.002228439800202639 -0.0022059812757960484 -0.0021831766645985101 -0.0021600429971215668 -0.0021365972427360436 -0.0021128562974532389 -0.0020888369719468947 -0.0020645559798239538 -0.0020400299261526533 -0.00201527529625882 -0.0019903084447931013 -0.0019651455850821647 -0.0019398027787672079 -0.0019142959257364561 -0.0018886407543611677 -0.001862852812035326 -0.0018369474560300247 -0.0018109398446632952 -0.0017848449287911627 -0.0017586774436255392 -0.0017324519008785899 -0.0017061825812415277 -0.0016798835271962936 -0.0016535685361652452 -0.0016272511539993095 -0.0016009446688063644 -0.001574662105121423 -0.0015484162184177322 -0.0015222194899613337 -0.001496084122006372 -0.0014700220333327269 -0.0014440448551232277 -0.0014181639271807073 -0.0013923902944816061 -0.0013667347040655295 -0.0013412076022573313 -0.0013158191322191967 -0.0012905791318292004 -0.0012654971318846187 -0.0012405823546231889 -0.0012158437125611779 -0.0011912898076422429 -0.0011669289306923958 -0.0011427690611774191 -0.0011188178672553867 -0.0010950827061209367 -0.0010715706246342549 ; ...
-0.0010482883602291188 -0.0010252423420939252 -0.0010024386926191509 -0.00097988322910444459 -0.0009575814657197014 -0.00093553861571092981 -0.00091375959384577474 -0.00089224901909146226 -0.00087101121751519128 -0.00085005022540258005 -0.00082936979258511553 -0.00080897338596773102 -0.0007888641932507906 -0.00076904512683720685 -0.00074951882791633034 -0.00073028767071792525 -0.00071135376692691918 -0.00069271897025068724 -0.00067438488113220896 -0.00065635285159877307 -0.0006386239902396694 -0.0006211991673039062 -0.00060407901990999421 -0.00058726395735989034 -0.00057075416654811875 -0.00055454961745972538 -0.00053865006874671134 -0.00052305507337766649 -0.00050776398435055034 -0.00049277596046226613 -0.00047808997212640467 -0.00046370480723278984 -0.00044961907704025271 -0.00043583122209566935 -0.00042233951817268606 -0.00040914208222213311 -0.00039623687832792027 -0.00038362172366119586 -0.00037129429442669948 -0.00035925213179433847 -0.00034749264780966314 -0.0003360131312778545 -0.00032481075361443824 -0.00031388257465736133 -0.00030322554843510187 -0.00029283652888439145 -0.00028271227551409251 -0.00027284945900835338 -0.00026324466676519963 -0.00025389440836636086 -0.00024479512097265455 -0.00023594317464165591 -0.00022733487756350194 -0.00021896648121047264 -0.00021083418539782645 -0.00020293414325081322 -0.00019526246607635966 -0.00018781522813546975 -0.00018058847131340559 -0.00017357820968576937 -0.00016678043397741959 -0.00016019111591229068 -0.00015380621245211301 -0.00014762166992198216 ; ...
-0.00014163342802158514 -0.00013583742372019888 -0.00013022959503438368 -0.00012480588468739796 -0.00011956224364945622 -0.00011449463455769299 -0.00010959903501602105 -0.00010487144077395562 -0.00010030786878440705 -9.5904360140353041e-05 -9.1656982890785761e-05 -8.7561834735643777e-05 -8.3615045600805675e-05 -7.9812780093316835e-05 -7.6151239837685299e-05 -7.2626665694028878e-05 -6.9235339859308838e-05 -6.5973587852332554e-05 -6.283778038432275e-05 -5.9824335115719884e-05 -5.6929718301387388e-05 -5.4150446325241619e-05 -5.148308712634071e-05 -4.8924261517881455e-05 -4.6470644401309827e-05 -4.4118965877058998e-05 -4.1866012254540477e-05 -3.9708626962839345e-05 -3.7643711364655731e-05 -3.5668225475443964e-05 -3.3779188591141675e-05 -3.1973679824346367e-05 -3.0248838554478756e-05 -2.8601864792035189e-05 -2.7030019460117427e-05 -2.5530624596496927e-05 -2.4101063477363887e-05 -2.2738780666407181e-05 -2.1441281991953524e-05 -2.0206134453061033e-05 -1.903096606004572e-05 -1.7913465609335527e-05 -1.6851382396537902e-05 -1.5842525870971702e-05 -1.4884765232639274e-05 -1.3976028975918551e-05 -1.3114304381644018e-05 -1.2297636959870056e-05 -1.1524129847372309e-05 -1.0791943160687827e-05 -1.0099293308617289e-05 -9.4444522653409002e-06 -8.825746808526882e-06 -8.2415577223299936e-06 -7.6903189701119903e-06 -7.1705168381408892e-06 -6.6806890518543492e-06 -6.2194238687391691e-06 -5.7853591484819365e-06 -5.3771814030569769e-06 -4.9936248297939885e-06 -4.6334703277817811e-06 -4.2955445009809775e-06 -3.9787186498441911e-06 ; ...
-3.6819077523264935e-06 -3.4040694379980591e-06 -3.1442029549795934e-06 -2.9013481330545681e-06 -2.6745843438466546e-06 -2.4630294598768868e-06 -2.2658388141136879e-06 -2.0822041610261059e-06 -1.9113526418700126e-06 -1.752545753505284e-06 -1.6050783245870309e-06 -1.4682774975368376e-06 -1.3415017203909727e-06 -1.2241397469503166e-06 -1.1156096485319445e-06 -1.0153578365875956e-06 -9.2285809840686415e-07 -8.3761064576180767e-07 -7.5914117757018768e-07 -6.8699995861937379e-07 -6.2076091213790515e-07 -5.6002073036607934e-07 -5.0439800035100044e-07 -4.5353234797948063e-07 -4.0708359974581441e-07 -3.6473096195087755e-07 -3.2617221884610985e-07 -2.9112294993316284e-07 -2.5931576445324776e-07 -2.3049955767443319e-07 -2.0443878384491862e-07 -1.8091274999025819e-07 -1.5971492888027674e-07 -1.4065229011524193e-07 -1.2354465230636466e-07 -1.0822405279765218e-07 -9.4534136892095902e-08 -8.2329566160385884e-08 -7.1475444571377608e-08 -6.1846763242743495e-08 -5.3327862728533556e-08 -4.5811913553623873e-08 -3.9200412788570196e-08 -3.340269809845923e-08 -2.8335477837232146e-08 -2.3922376287569348e-08 -2.0093495183098244e-08 -1.6784988720710209e-08 -1.3938653319919436e-08 -1.1501530523751641e-08 -9.4255227227855564e-09 -7.6670211007207855e-09 -6.1865448822202854e-09 -4.9483914369199242e-09 -3.9202964004620994e-09 -3.0731030622950433e-09 -2.3804402001404794e-09 -1.8184078576220345e-09 -1.3652700487751244e-09 -1.0011534324133162e-09 -7.0775185243131505e-10 -4.6803486690993206e-10 -2.6596054498854228e-10 -8.6190819244262625e-11 ];
[nrow, ncol] = size(data);
n1 = max(nrow,ncol);
data = reshape(data, 1, n1);
if (n1 <= 49)
  error('length of input vector must be greater than 49');
end
dt = n1/n2;
shift2exact = 79.5 / dt + 2;
shift2 = floor(shift2exact);
shift2Fract = shift2exact - shift2;
x = [data(end - 48:end) data data(1:41)];
c = zeros(1,49);
s = zeros(1,11);
nx = length(x) - 10;
y = zeros(1, ceil((n1 + 80)/dt));
t = 0;
ix = 1;
iy = 0;
while ix <= nx
    while t >= 1.0
        c = [x(ix) c(1:48)];   %   right shift data in
        ix = ix + 1;
        ctmp = c(1:24) + c(49:-1:26);
        ctmp = ctmp * c_tap(1:24) + c(25) * c_tap(25);
        s = [ctmp, s(1:10)];
        t = t - 1;
    end
    iy = iy + 1;
    tmp = t * 64;
    coarse = floor(tmp);
    fine = tmp - coarse;
    coarse = coarse + 1;    %   1 index
    s_tap = s0(:, coarse) + s1(:, coarse) * fine;
    y(iy) = s * s_tap;
    t = t + dt;   
end
y1 = y(shift2:shift2+n2-1);
% tn = ((1:n2) - shift2Fract) * dt;
if (nrow > ncol)
    y1 = reshape(y1, length(y1), 1);
end
result = y1;
